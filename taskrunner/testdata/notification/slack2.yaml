apiVersion: iter8.tools/v2beta1
kind: Experiment
metadata:
  name: quickstart-exp
  namespace: default
spec:
  criteria:
    objectives:
    - metric: iter8-istio/mean-latency
      upperLimit: 300
    - metric: iter8-istio/error-rate
      upperLimit: "0.01"
    rewards:
    - metric: iter8-istio/user-engagement
      preferredDirection: High
  duration:
    minIntervalBetweenLoops: 10
    maxLoops: 5
  actions:
    finish:
    - task: common/exec
      with:
        args:
        - -c
        - kubectl -n bookinfo-iter8 apply -f {{ .promote }}
        cmd: /bin/bash
    - task: notification/slack
      with:
        channel: CU5FNKWCB
        secret: default/slack-secret
    start:
    - task: notification/slack
      with:
        channel: CU5FNKWCB
        secret: default/slack-secret
  versionInfo: ["productpage-v1", "productpage-v2"]
status:
  completedIterations: 0
  conditions:
  - lastTransitionTime: "2021-05-21T12:45:19Z"
    message: Start actions failed
    reason: ExperimentCompleted
    status: "True"
    type: Completed
  - lastTransitionTime: "2021-05-21T12:45:19Z"
    message: Start actions failed
    reason: HandlerFailed
    status: "True"
    type: Failed
  startTime: "2021-05-21T12:45:06Z"
  lastUpdateTime: "2021-05-21T12:45:06Z"
  message: 'ExperimentCompleted: Start actions failed'
  stage: Completed
  testingPattern: Hybrid-A/B
